@model IEnumerable<HeyTeam.Core.Availability>
@using HeyTeam.Util

<h2>Availability</h2>
<h3>Currently Unavailable</h3>
<div>
    <div class="btn-group" role="group" aria-label="...">
        <a class="btn btn-primary" id="AddAvailibilityButton" asp-area="Administration" asp-controller="Availability" asp-action="New">Add Availability Status</a>
        <a class="btn btn-primary" id="CheckHistoryButton" href="#">Check Availability History</a>
    </div>
</div>
<div class="table-responsive">
    <table class="table table-bordered table-hover">
        <thead>
            <tr>
                <th>Squad Name</th>
                <th>Player Name</th>
                <th>Status</th>
                <th>Date From</th>
                <th>Date To</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var availability in Model) {
                <tr data-availabilityId="@availability.AvailabilityId">
                    <td>@availability.SquadName</td>
                    <td><a asp-area="Administration" asp-controller="Availability" asp-action="Edit" asp-route-availabilityId="@availability.AvailabilityId">@availability.PlayerName</a></td>
                    <td>
                        @(availability.AvailabilityStatus == HeyTeam.Core.AvailabilityStatus.Injured ? "Injured" :
                                (availability.AvailabilityStatus == HeyTeam.Core.AvailabilityStatus.OutOfTown ? "Out of town" :
                                    (availability.AvailabilityStatus == HeyTeam.Core.AvailabilityStatus.Other ? "Other" : "Unknown"

                        )))
                    </td>
                    <td>@availability.DateFrom.ToString("dd MMM yyyy")</td>
                    <td>@(availability.DateTo.HasValue ? @availability.DateTo.Value.ToString("dd MMM yyyy") : "Unknown")</td>
                    <td>@Html.Raw(availability.Notes.IsEmpty() || availability.Notes.Length < 25 ? availability.Notes : $"<span data-toggle='tooltip' title=\"{availability.Notes}\">{availability.Notes.Substring(0, 25)}...</span>")</td>                    
                </tr>
            }
        </tbody>
    </table>
</div>

@section Scripts {
    <script>
        $(document).ready(function(){
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
}